{
    "description": "Log Min Messages Database Flag for PostgreSQL Instance Insufficient",
    "rationale": "Auditing helps in troubleshooting operational problems and also permits forensic analysis. If log_min_messages is too strict, potentially important messages may not be logged appropriately. Considering general log messages as error messages would make it difficult to find actual errors, while considering only stricter severity levels as error messages may skip actual errors to log their SQL statements. The log_min_messages flag should be set in accordance with the organization's logging policy. This recommendation is applicable to PostgreSQL database instances.",
    "remediation": "From console:<ol><li>Go to the Cloud SQL Instances page in the Google Cloud Console by visiting https://console.cloud.google.com/sql/instances.</li><li>Select the PostgreSQL instance where the database flag needs to be enabled.</li><li>Click <samp>Edit</samp></li><li>Scroll down to the <samp>Flags</samp> section.</li><li>To set a flag that has not been set on the instance before, click <samp>Add item</samp>, choose the flag <samp>log_min_messages</samp> from the drop-down menu, and set appropriate value.</li><li>Click <samp>Save</samp></li><li>Confirm the changes under <samp>Flags</samp> on the Overview page.</li></ol>",
    "compliance": [
        {
            "name": "App Defense Alliance Cloud Profile",
            "version": "1.0",
            "reference": "6.15.4"
        }
    ],
    "references": [
        "https://github.com/appdefensealliance/ASA-WG/blob/main/Cloud%20App%20and%20Config%20Profile/Cloud%20App%20and%20Config%20Test%20Guide.md#6154-ensure-that-the-log_min_messages-flag-for-a-cloud-sql-postgresql-instance-is-set-at-minimum-to-warning",
        "https://www.postgresql.org/docs/9.6/runtime-config-logging.html#RUNTIME-CONFIG-LOGGING-WHEN",
        "https://cloud.google.com/sql/docs/postgres/flags"
    ],
    "dashboard_name": "Instances",
    "path": "cloudsql.projects.id.instances.id",
    "conditions": [
        "or",
        [
            "cloudsql.projects.id.instances.id.log_min_messages",
            "containAtLeastOneOf",
            [
                "error",
                "log",
                "fatal",
                "panic"
            ]
        ]
    ],
    "id_suffix": "log_min_messages"
}