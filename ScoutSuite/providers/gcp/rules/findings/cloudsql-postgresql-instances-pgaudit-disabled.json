{
    "description": "Centralized Logging for PostgreSQL Instance Disabled",
    "rationale": "As numerous other requirements in this section consist of turning on flags for logging purposes, your organization will need a way to manage these logs. You may have a solution already in place. If you do not, consider installing and enabling the open source pgaudit extension within PostgreSQL and enabling its corresponding flag of cloudsql.enable_pgaudit. This flag and installing the extension enables database auditing in PostgreSQL through the open-source pgAudit extension. This extension provides detailed session and object logging to comply with government, financial, & ISO standards and provides auditing capabilities to mitigate threats by monitoring security events on the instance. Enabling the flag and settings later in this requirement will send these logs to Google Logs Explorer so that you can access them in a central location.",
    "remediation": "Ensure That 'cloudsql.enable_pgaudit' Database Flag for each Cloud Sql Postgresql Instance Is Set to 'on' For Centralized Logging.",
    "compliance": [
        {
            "name": "CIS Google Cloud Platform Foundations",
            "version": "1.1.0",
            "reference": "6.2.2"
        },
        {
            "name": "App Defense Alliance Cloud Profile",
            "version": "1.0",
            "reference": "6.15.7"
        }
    ],
    "references": [
        "https://github.com/appdefensealliance/ASA-WG/blob/main/Cloud%20App%20and%20Config%20Profile/Cloud%20App%20and%20Config%20Test%20Guide.md#6157-ensure-that-cloudsqlenable_pgaudit-database-flag-for-each-cloud-sql-postgresql-instance-is-set-to-on-for-centralized-logging",
        "https://www.postgresql.org/docs/9.6/runtime-config-logging.html#RUNTIME-CONFIG-LOGGING-WHAT",
        "https://cloud.google.com/sql/docs/postgres/flags"
    ],
    "dashboard_name": "Instances",
    "path": "cloudsql.projects.id.instances.id",
    "conditions": [
        "and",
        [
            "cloudsql.projects.id.instances.id.cloudsql_enable_pgaudit",
            "false",
            ""
        ]
    ],
    "id_suffix": "cloudsql_enable_pgaudit"
}