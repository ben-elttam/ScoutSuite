{
    "description": "Potential Secrets in Function Environment Variables (Gen 1)",
    "rationale": "Anyone who can access the function can view the configured secrets. Best practice is to store configuration secrets in Secret Manager (or similar).",
    "dashboard_name": "Functions",
    "path": "functions.projects.id.functions_v1.id",
    "compliance": [
        {
            "name": "App Defense Alliance Cloud Profile",
            "version": "1.0.0",
            "reference": "2.6.1"
        }
    ],
    "references": [
        "https://github.com/appdefensealliance/ASA-WG/blob/main/Cloud%20App%20and%20Config%20Profile/Cloud%20App%20and%20Config%20Test%20Guide.md#261-ensure-secrets-are-not-stored-in-cloud-functions-environment-variables-by-using-secret-manager",
        "https://cloud.google.com/functions/1stgendocs/configuring/secrets"
    ],
    "conditions": [
        "or",
        [
            "functions.projects.id.functions_v1.id.environment_variables_secrets",
            "notEmpty",
            ""
        ]
    ],
    "id_suffix": "environment_variables_secrets"
}